@page "/"
@using Blazor.Models
@using Blazor.Services
@inject BikeService BikeService // Inject the BikeService to fetch bike data
@rendermode InteractiveServer  // Enable interactive Blazor Server rendering
@inject NavigationManager NavigationManager

<!-- Hero section with a background video -->
<header class="hero-section">
    <video autoplay loop muted playsinline class="hero-video">
        <source src="videos/bikeshop.mp4" type="video/mp4">
    </video>

    <div class="hero-overlay"></div> <!-- Dark overlay for better text readability -->

    <div class="hero-content">
        <h1>Welcome</h1>
        <p>Discover bikes for every ride</p>
    </div>
</header>

<!-- Section for newest bike products -->
<section class="new-products">
    <h2>Newest Products</h2>
</section>

<!-- Display newest bikes in a card layout -->
<div class="bikes-container">
    @foreach (var bike in NewestBikes)
    {
        // Creates a SaleCard component and passes the current Bike object to it via the [Parameter] property `public Bike Bike { get; set; }`.
        // We do not create a new Bike inside the card; the card receives the Bike object from the parent.
        // Each card gets its own Bike instance from the NewestBikes list.
        <SaleCard Bike="bike" />
    }
</div>

@code {

    // should not make new Bike here, it comes from GetNewestBikes(list with bikes) 
    // public Bike Bike { get; set; }

    private void OpenSalesCard(int bikeId)
    {
        NavigationManager.NavigateTo($"/saledetail/{bikeId}");
    }

    private List<Bike> NewestBikes = new List<Bike>(); // List to store newest bikes

    protected override void OnInitialized()
    {
        // Fetch newest bikes from BikeService when component initializes
        NewestBikes = BikeService.GetNewestBikes();
    }
}
